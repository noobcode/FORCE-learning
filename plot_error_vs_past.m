clear all
close all

%% Q = 0, f = 5 Hz

Q=0;
past = 0:10:100;

mean_error = [0.4830, 0.4774, 0.4731, 0.4721, 0.4749, 0.4803, 0.4863, 0.4906, 0.4915, 0.4888, 0.4834];
mean_error_std = [0.0168, 0.0148, 0.0168, 0.0228, 0.0287, 0.0316, 0.0303, 0.0261, 0.0215, 0.0184, 0.0163];

mean_error_s1 = [0.4044, 0.3888, 0.3746, 0.3663, 0.3670, 0.3764, 0.3910, 0.4052, 0.4135, 0.4129, 0.4034];
mean_error_std_s1 = [0.0470, 0.0421, 0.0369, 0.0346, 0.0338, 0.0338, 0.0368, 0.0431, 0.0492, 0.0512, 0.0481];

mean_error_s2 = [0.5321, 0.5327, 0.5346, 0.5383, 0.5424, 0.5453, 0.5459, 0.5440, 0.5403, 0.5362, 0.5333];
mean_error_std_s2 = [0.0233, 0.0216, 0.0217, 0.0257, 0.0322, 0.0372, 0.0380, 0.0346, 0.0292, 0.0251, 0.0230];
%{
figure(1)
hold on
errorbar(past, mean_error, mean_error_std, 'LineWidth',2)
errorbar(past, mean_error_s1, mean_error_std_s1, 'LineWidth',2)
errorbar(past, mean_error_s2, mean_error_std_s2, 'LineWidth',2)
xlabel('past (ms)')
ylabel('average error')
legend('Post-training', 'Stage 1', 'Stage 2', 'Location', 'best')
hold off
%}
%% with feedback... Q = 5x10^3

Q=5*10^3;
past = 0:10:100;

    %% f = 1 Hz
mean_error = [0.6684 0.5929 0.8722 0.5698 0.8576 0.6811 0.7006 0.7201 0.8840 0.5859 0.8223];
mean_error_std = [0.3812 0.2465 0.4900 0.2747 0.3781 0.2747 0.3451 0.3518 0.2628 0.3566 0.5117];
   
mean_error_s1 = [0.3403 0.4439 0.6198 0.3508 0.6905 0.3047 0.4609 0.5503 0.5973 0.2848 0.6766];
mean_error_std_s1 = [0.3582 0.2575 0.5556 0.2832 0.4317 0.1817 0.3140 0.3201 0.2837 0.2808 0.4824];
    
mean_error_s2 = [0.9965 0.7418 1.1246 0.7889 1.0247 1.0575 0.9403 0.8898 1.1707 0.8871 0.9680];
mean_error_std_s2 = [0.5281 0.3909 0.5326 0.4251 0.5612 0.4604 0.5316 0.4544 0.4935 0.5343 0.5786];
    %% f = 5 Hz
%{
mean_error = [0.9094, 0.7180, 0.5451, 0.1553, 0.2777, 0.4257, 0.4049, 0.3124, 0.6181, 0.7570, 0.8115];
mean_error_std = [0.2753, 0.3074, 0.3257, 0.1593, 0.2651, 0.3618, 0.3366, 0.1839, 0.3676, 0.3329, 0.3151];

mean_error_s1 = [0.2630, 0.1664, 0.1365, 0.0230, 0.0515, 0.0856, 0.0882, 0.0519, 0.1464, 0.2055, 0.2026];
mean_error_std_s1 = [0.1370, 0.1097, 0.0962, 0.0205, 0.0463, 0.0991, 0.0830, 0.0397, 0.1038, 0.1504, 0.1186];

mean_error_s2 = [1.3134, 1.0628, 0.8005, 0.2380, 0.4191, 0.6382, 0.6028, 0.4752, 0.9129, 1.1018, 1.1921];
mean_error_std_s2 = [0.3765, 0.4382, 0.4758, 0.2511, 0.4043, 0.5350, 0.5007, 0.2829, 0.5359, 0.4578, 0.4554];
%}
    %% f = 7 Hz
%{
mean_error = [0.9678 0.8849 0.7395 0.5135 0.7295 0.8294 0.9848 1.0894 0.8291 0.5103 0.5645];
mean_error_std = [0.1409 0.3597 0.2156 0.2803 0.3265 0.3805 0.2758 0.1028 0.1747 0.3123 0.3286];

mean_error_s1 = [0.3500 0.2399 0.1571 0.0824 0.2137 0.2318 0.3371 0.3917 0.1965 0.1195 0.1224];
mean_error_std_s1 = [0.2030 0.1805 0.0717 0.0615 0.2037 0.1640 0.2278 0.1393 0.1840 0.0855 0.1001];

mean_error_s2 = [1.3539 1.2880 1.1035 0.7829 1.0519 1.2029 1.3895 1.5255 1.2245 0.7545 0.8407];
mean_error_std_s2 = [0.2536 0.4965 0.3171 0.4184 0.4317 0.5285 0.3198 0.1862 0.2384 0.4591 0.4865];
%}
    
    %% f = 12 Hz
%{
mean_error = [0.6438 0.5386 0.4644 0.6780 0.7699 0.4239 0.6000 0.6903 0.7775 0.3514 0.6166];
mean_error_std = [0.5403 0.4237 0.3356 0.4124 0.4303 0.3604 0.3094 0.4422 0.3934 0.2642 0.4254];

mean_error_s1 = [0.3039 0.1986 0.0887 0.1854 0.3033 0.0948 0.1192 0.1516 0.1975 0.0692 0.1367];
mean_error_std_s1 = [0.3949 0.2897 0.0975 0.1493 0.2793 0.1115 0.1345 0.1762 0.1673 0.0601 0.1536];

mean_error_s2 = [0.8563 0.7512 0.6992 0.9859 1.0615 0.6296 0.9006 1.0270 1.1399 0.5277 0.9165];
mean_error_std_s2 = [0.6920 0.5714 0.4890 0.6128 0.5816 0.5243 0.4306 0.6279 0.5621 0.4008 0.6237];
%}
    %% plot

figure(2)
hold on
errorbar(past, mean_error, mean_error_std, 'LineWidth',2)
errorbar(past, mean_error_s1, mean_error_std_s1, 'LineWidth',2)
errorbar(past, mean_error_s2, mean_error_std_s2, 'LineWidth',2)
xlabel('past (ms)')
ylabel('average error')
legend('Post-training', 'Stage 1', 'Stage 2', 'Location', 'best')
hold off

%%
